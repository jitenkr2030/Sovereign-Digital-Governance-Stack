<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 500" width="1000" height="500">
  <defs>
    <marker id="arrow-flow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#334155"/>
    </marker>
    <filter id="drop-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-color="#000000" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1000" height="500" fill="#F8FAFC"/>

  <!-- Title -->
  <text x="500" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="700" fill="#0F172A" text-anchor="middle">SIGNAL FLOW LOGIC</text>
  <text x="500" y="58" font-family="system-ui, -apple-system, sans-serif" font-size="13" fill="#64748B" text-anchor="middle">How Economic Signals Trigger Governance Actions</text>

  <!-- Flow Container -->
  <rect x="30" y="80" width="940" height="380" rx="12" fill="#FFFFFF" stroke="#E2E8F0" stroke-width="2"/>

  <!-- Step 1: NEAM Sensor Input -->
  <g transform="translate(80, 140)">
    <circle cx="60" cy="60" r="50" fill="#22C55E" filter="url(#drop-shadow)"/>
    <circle cx="60" cy="45" r="15" fill="#FFFFFF" opacity="0.3"/>
    <path d="M 45 50 Q 60 35 75 50 Q 60 70 45 50" fill="#FFFFFF"/>
    <text x="60" y="75" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#FFFFFF" text-anchor="middle">SENSOR</text>
    <rect x="0" y="125" width="120" height="60" rx="8" fill="#16A34A" opacity="0.2"/>
    <text x="60" y="150" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#166534" text-anchor="middle">NEAM Input</text>
    <text x="60" y="168" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#15803D">Economic Event</text>
  </g>

  <!-- Arrow 1 -->
  <path d="M 190 200 L 260 200" stroke="#334155" stroke-width="2" marker-end="url(#arrow-flow)"/>
  <rect x="195" y="185" width="55" height="30" rx="4" fill="#F1F5F9" stroke="#CBD5E1"/>
  <text x="222" y="205" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#64748B">Raw Data</text>

  <!-- Step 2: Data Classification -->
  <g transform="translate(270, 140)">
    <rect x="0" y="20" width="140" height="120" rx="10" fill="#3B82F6" filter="url(#drop-shadow)"/>
    <rect x="50" y="50" width="40" height="40" rx="5" fill="#FFFFFF"/>
    <rect x="60" y="60" width="20" height="20" rx="2" fill="#3B82F6"/>
    <text x="70" y="115" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#FFFFFF" text-anchor="middle">CLASSIFY</text>
    <rect x="10" y="155" width="120" height="45" rx="6" fill="#2563EB" opacity="0.2"/>
    <text x="70" y="178" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#1E40AF" text-anchor="middle">Verification</text>
    <text x="70" y="193" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#1D4ED8">&amp; Normalization</text>
  </g>

  <!-- Arrow 2 -->
  <path d="M 430 200 L 500 200" stroke="#334155" stroke-width="2" marker-end="url(#arrow-flow)"/>
  <rect x="435" y="185" width="55" height="30" rx="4" fill="#F1F5F9" stroke="#CBD5E1"/>
  <text x="462" y="205" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#64748B">Verified</text>

  <!-- Step 3: Signal Contract Trigger (Diamond) -->
  <g transform="translate(510, 130)">
    <polygon points="70,0 140,50 70,100 0,50" fill="#F59E0B" filter="url(#drop-shadow)"/>
    <text x="70" y="45" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="700" fill="#FFFFFF" text-anchor="middle">SIGNAL</text>
    <text x="70" y="60" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="700" fill="#FFFFFF" text-anchor="middle">CONTRACT</text>
    <text x="70" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#FEF3C7">Threshold Check</text>
    <rect x="-10" y="115" width="160" height="55" rx="6" fill="#D97706" opacity="0.2"/>
    <text x="70" y="138" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#92400E" text-anchor="middle">Policy Trigger?</text>
    <text x="70" y="155" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#B45309">Risk Evaluation</text>
  </g>

  <!-- Decision Paths -->
  <!-- YES Path (Top) -->
  <path d="M 650 155 L 720 155" stroke="#334155" stroke-width="2" marker-end="url(#arrow-flow)"/>
  <rect x="660" y="140" width="50" height="30" rx="4" fill="#DCFCE7" stroke="#86EFAC"/>
  <text x="685" y="160" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#166534" text-anchor="middle">YES</text>

  <!-- NO Path (Bottom) -->
  <path d="M 650 235 L 720 235" stroke="#334155" stroke-width="2" marker-end="url(#arrow-flow)"/>
  <rect x="660" y="220" width="50" height="30" rx="4" fill="#FEE2E2" stroke="#FCA5A5"/>
  <text x="685" y="240" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#991B1B" text-anchor="middle">NO</text>

  <!-- Step 4a: CSIC Allocation/Restriction (YES branch) -->
  <g transform="translate(730, 115)">
    <rect x="0" y="0" width="130" height="100" rx="10" fill="#1E3A8A" filter="url(#drop-shadow)"/>
    <rect x="45" y="30" width="40" height="35" rx="4" fill="#FFFFFF"/>
    <rect x="55" y="40" width="20" height="15" rx="2" fill="#1E3A8A"/>
    <text x="65" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#FFFFFF" text-anchor="middle">CSIC</text>
    <text x="65" y="95" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#93C5FD">Governance Action</text>
    <rect x="0" y="115" width="130" height="50" rx="6" fill="#1E40AF" opacity="0.3"/>
    <text x="65" y="138" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#FFFFFF" text-anchor="middle">Allocate/Restrict</text>
    <text x="65" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#BFDBFE">Policy Enforcement</text>
  </g>

  <!-- Step 4b: Continue Monitoring (NO branch) -->
  <g transform="translate(730, 285)">
    <rect x="0" y="0" width="130" height="80" rx="10" fill="#64748B" filter="url(#drop-shadow)"/>
    <circle cx="65" cy="35" r="20" fill="#FFFFFF"/>
    <path d="M 55 35 L 65 25 L 75 35 L 65 45 Z" fill="#64748B"/>
    <text x="65" y="70" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#FFFFFF" text-anchor="middle">Continue</text>
    <text x="65" y="85" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#CBD5E1">Monitoring</text>
  </g>

  <!-- Merge point indicator -->
  <g transform="translate(870, 170)">
    <line x1="0" y1="30" x2="0" y2="130" stroke="#94A3B8" stroke-width="2" stroke-dasharray="4,4"/>
  </g>

  <!-- Arrow to Audit -->
  <path d="M 870 200 L 940 200" stroke="#334155" stroke-width="2" marker-end="url(#arrow-flow)"/>
  <rect x="875" y="185" width="55" height="30" rx="4" fill="#F1F5F9" stroke="#CBD5E1"/>
  <text x="902" y="205" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#64748B">Action</text>

  <!-- Step 5: Audit Log Entry -->
  <g transform="translate(770, 380)">
    <rect x="0" y="0" width="180" height="90" rx="10" fill="#1E293B" filter="url(#drop-shadow)"/>
    <rect x="30" y="20" width="30" height="50" rx="3" fill="#475569"/>
    <rect x="40" y="30" width="10" height="30" rx="1" fill="#64748B"/>
    <rect x="40" y="40" width="10" height="20" rx="1" fill="#94A3B8"/>
    <rect x="40" y="50" width="10" height="10" rx="1" fill="#CBD5E1"/>
    <rect x="75" y="25" width="75" height="8" rx="2" fill="#64748B"/>
    <rect x="75" y="38" width="55" height="8" rx="2" fill="#64748B"/>
    <rect x="75" y="51" width="65" height="8" rx="2" fill="#64748B"/>
    <text x="90" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#FFFFFF" text-anchor="middle">Audit Log</text>
    <text x="90" y="95" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#94A3B8">Immutable Record</text>
  </g>

  <!-- Legend -->
  <g transform="translate(50, 420)">
    <rect x="0" y="0" width="280" height="60" rx="6" fill="#F1F5F9" stroke="#E2E8F0"/>
    <text x="10" y="18" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#334155">Legend</text>
    <circle cx="30" cy="35" r="8" fill="#22C55E"/>
    <text x="45" y="39" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#475569">Economic Event</text>
    <rect x="120" y="27" width="16" height="16" rx="2" fill="#3B82F6"/>
    <text x="145" y="39" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#475569">Processing</text>
    <polygon points="205,27 221,35 205,43 189,35" fill="#F59E0B"/>
    <text x="228" y="39" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#475569">Decision</text>
  </g>

  <!-- Signal Type Indicators -->
  <g transform="translate(400, 445)">
    <rect x="0" y="0" width="200" height="35" rx="4" fill="#F8FAFC" stroke="#E2E8F0"/>
    <text x="10" y="23" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#64748B">Signal Contracts: </text>
    <rect x="105" y="8" width="85" height="19" rx="3" fill="#0F766E"/>
    <text x="147" y="21" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#FFFFFF">JSON / Protobuf</text>
  </g>
</svg>
