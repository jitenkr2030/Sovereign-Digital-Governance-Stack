apiVersion: v1
kind: Secret
metadata:
  name: payment-adapter-secrets
  namespace: neam-production
  labels:
    app: payment-adapter
type: Opaque
stringData:
  # Redis password (base64 encoded value will be applied)
  REDIS_PASSWORD: "${REDIS_PASSWORD_BASE64}"
  
  # Kafka SASL credentials (if using SASL authentication)
  KAFKA_SASL_USERNAME: "${KAFKA_SASL_USERNAME}"
  KAFKA_SASL_PASSWORD: "${KAFKA_SASL_PASSWORD}"
  
  # TLS certificates (paths to mounted secrets)
  KAFKA_TLS_CERT: "/etc/certs/kafka/client.crt"
  KAFKA_TLS_KEY: "/etc/certs/kafka/client.key"
  KAFKA_CA_CERT: "/etc/certs/kafka/ca.crt"
  
  # Encryption key for sensitive data (32-byte base64 encoded)
  ENCRYPTION_KEY: "${ENCRYPTION_KEY_BASE64}"
---
# Role-based access control for Payment Adapter
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: payment-adapter-role
  namespace: neam-production
rules:
  - apiGroups: [""]
    resources: ["configmaps", "secrets", "pods", "pods/log"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["pods/exec"]
    verbs: ["create"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: payment-adapter-rolebinding
  namespace: neam-production
subjects:
  - kind: ServiceAccount
    name: payment-adapter-sa
    namespace: neam-production
roleRef:
  kind: Role
  name: payment-adapter-role
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: payment-adapter-sa
  namespace: neam-production
  labels:
    app: payment-adapter
