# Vault Secret Paths and Structure
# This document defines the secret hierarchy for NEAM Platform

# Secret Structure Overview
# =========================
# secret/
# ├── dev/
# │   ├── database/
# │   │   ├── postgresql/
# │   │   ├── redis/
# │   │   ├── mongodb/
# │   │   └── elasticsearch/
# │   ├── kafka/
# │   ├── external/
# │   └── application/
# ├── staging/
# │   ├── database/
# │   │   ├── postgresql/
# │   │   ├── redis/
# │   │   ├── mongodb/
# │   │   └── elasticsearch/
# │   ├── kafka/
# │   ├── external/
# │   └── application/
# └── production/
#     ├── database/
#     │   ├── postgresql/
#     │   ├── redis/
#     │   ├── mongodb/
#     │   └── elasticsearch/
#     ├── kafka/
#     ├── external/
#     └── application/

# Database Secrets
# ================

# PostgreSQL Secrets
secret/production/database/postgresql/
├── username          # PostgreSQL username
├── password          # PostgreSQL password
├── connection_string # Full connection string with credentials
└── ssl_cert          # PostgreSQL SSL certificate (if required)

secret/staging/database/postgresql/
├── username
├── password
└── connection_string

secret/dev/database/postgresql/
├── username
├── password
└── connection_string

# Redis Secrets
secret/production/database/redis/
├── password          # Redis password
└── connection_string # Full Redis connection string

secret/staging/database/redis/
├── password
└── connection_string

secret/dev/database/redis/
└── password

# MongoDB Secrets
secret/production/database/mongodb/
├── username          # MongoDB username
├── password          # MongoDB password
└── connection_string # Full MongoDB connection string

secret/staging/database/mongodb/
├── username
├── password
└── connection_string

secret/dev/database/mongodb/
├── username
├── password
└── connection_string

# Elasticsearch Secrets
secret/production/elasticsearch/
├── api_key      # Elasticsearch API key
├── username     # Elasticsearch username
└── password     # Elasticsearch password

secret/staging/elasticsearch/
├── api_key
├── username
└── password

# Kafka Secrets
# =============

secret/production/kafka/
├── sasl_username  # Kafka SASL username
├── sasl_password  # Kafka SASL password
├── ssl_cert       # Kafka SSL certificate
├── ssl_key        # Kafka SSL private key
└── ssl_ca         # Kafka SSL CA certificate

secret/staging/kafka/
├── sasl_username
├── sasl_password
├── ssl_cert
└── ssl_key

secret/dev/kafka/
└── sasl_username

# External Services
# =================

secret/production/external/
├── api_keys      # JSON object with external API keys
├── webhook_urls  # JSON object with webhook URLs
└── tokens        # JSON object with service tokens

secret/staging/external/
├── api_keys
├── webhook_urls
└── tokens

# Application Secrets
# ===================

secret/production/application/
├── jwt_secret       # JWT signing secret
├── encryption_key   # Data encryption key
├── session_secret   # Session management secret
└── api_keys         # Application API keys

secret/staging/application/
├── jwt_secret
├── encryption_key
└── session_secret

secret/dev/application/
├── jwt_secret
├── encryption_key
└── session_secret

# Certificate Secrets (if using external certificates)
# ====================================================

secret/production/certs/
├── tls.crt     # Main TLS certificate
├── tls.key     # TLS private key
├── ca.crt      # CA certificate
└── intermediate.crt  # Intermediate CA certificate

# Example Secret Values
# =====================

# PostgreSQL Production
vault kv put secret/production/database/postgresql \
  username="neam_production" \
  password="secure_password_here" \
  connection_string="postgresql://neam_production:secure_password@neam-prod-postgresql-primary.production:5432/neam_production?sslmode=require"

# Redis Production
vault kv put secret/production/database/redis \
  password="redis_password" \
  connection_string="redis://:redis_password@neam-prod-redis-master.production:6379"

# Kafka Production
vault kv put secret/production/kafka \
  sasl_username="neam_producer" \
  sasl_password="kafka_password" \
  ssl_cert="$(cat kafka.crt)" \
  ssl_key="$(cat kafka.key)" \
  ssl_ca="$(cat ca.crt)"

# Application Secrets
vault kv put secret/production/application \
  jwt_secret="$(openssl rand -base64 32)" \
  encryption_key="$(openssl rand -base64 32)" \
  session_secret="$(openssl rand -base64 32)"

# External API Keys
vault kv put secret/production/external \
  api_keys='{"stripe": "sk_live_xxx", "sendgrid": "SG.xxx"}' \
  webhook_urls='{"alerts": "https://hooks.example.com/alerts", "metrics": "https://hooks.example.com/metrics"}'
