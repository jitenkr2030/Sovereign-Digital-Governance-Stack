# 威胁模型分析

## 概述

本文档描述CSIC平台的安全威胁模型，包括潜在威胁、攻击面分析和缓解措施。

## 信任边界

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              外部区域                                        │
│  • 互联网                                                                   │
│  • 第三方API提供商                                                           │
│  • 未知来源                                                                 │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                    ┌─────────────────┴─────────────────┐
                    │            DMZ区域                  │
                    │  • API Gateway (WAF保护)           │
                    │  • 负载均衡器                       │
                    │  • DDoS防护                        │
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────┴─────────────────┐
                    │          应用服务区域               │
                    │  • 核心控制层服务                   │
                    │  • 交易所监管服务                   │
                    │  • 区块链分析服务                   │
                    │  • 挖矿控制服务                     │
                    │  • 合规管理服务                     │
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────┴─────────────────┐
                    │           数据存储区域              │
                    │  • PostgreSQL主库                   │
                    │  • TimescaleDB                      │
                    │  • Redis集群                        │
                    │  • WORM存储                         │
                    │  • OpenSearch                      │
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────┴─────────────────┐
                    │          管理区域                   │
                    │  • 运维管理终端                     │
                    │  • 审计查询终端                     │
                    │  • 备份管理系统                     │
                    └───────────────────────────────────┘
```

## 威胁分类

### 1. 外部威胁

| 威胁 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| DDoS攻击 | 分布式拒绝服务攻击 | 高 | 高 | DDoS防护、速率限制、CDN |
| API滥用 | 恶意API请求 | 高 | 中 | 认证、授权、限流 |
| 注入攻击 | SQL/命令注入 | 中 | 高 | 输入验证、参数化查询 |
| 中间人攻击 | MITM攻击 | 低 | 高 | TLS 1.3、双向认证 |
| 数据窃取 | 敏感数据泄露 | 中 | 高 | 加密存储、访问控制 |
| 供应链攻击 | 第三方组件攻击 | 低 | 高 | 依赖审查、签名验证 |

### 2. 内部威胁

| 威胁 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| 权限滥用 | 管理员权限滥用 | 中 | 高 | RBAC、双人控制 |
| 数据篡改 | 内部人员修改数据 | 低 | 高 | WORM存储、审计追踪 |
| 审计规避 | 试图删除审计日志 | 低 | 高 | WORM只写一次存储 |
| 密钥泄露 | 加密密钥泄露 | 低 | 高 | HSM管理、密钥轮换 |
| 配置错误 | 系统配置错误 | 中 | 中 | 配置审核、自动化验证 |

### 3. 平台威胁

| 威胁 | 描述 | 可能性 | 影响 | 缓解措施 |
|------|------|--------|------|----------|
| 数据库泄露 | 数据库漏洞利用 | 低 | 高 | 最小权限、网络隔离 |
| 消息队列攻击 | Kafka安全漏洞 | 低 | 中 | SASL认证、TLS加密 |
| 容器逃逸 | Docker/K8s漏洞 | 低 | 高 | 运行时安全、Pod安全策略 |
| 加密绕过 | 加密实现缺陷 | 低 | 高 | 密码学审计、标准算法 |

## 攻击场景

### 场景1: API认证绕过

**攻击向量**: 攻击者尝试绕过API认证获取敏感数据

**缓解措施**:
- JWT令牌验证
- 令牌过期机制
- 请求签名验证
- 异常行为检测

### 场景2: 区块链数据篡改

**攻击向量**: 攻击者试图修改区块链分析数据

**缓解措施**:
- 数据源验证
- 多数据源交叉验证
- 不可变日志存储
- 链式哈希验证

### 场景3: 审计日志删除

**攻击向量**: 攻击者试图删除或修改审计日志

**缓解措施**:
- WORM存储（只写一次）
- 链式哈希存储
- 异地备份
- 访问控制

### 场景4: 挖矿设备劫持

**攻击向量**: 攻击者试图劫持挖矿控制权限

**缓解措施**:
- 双向认证
- 设备证书验证
- 操作审计
- 远程禁用能力

## 安全控制措施

### 身份认证

- 多因素认证 (MFA)
- 证书认证
- API密钥认证
- 服务间认证 (mTLS)

### 访问控制

- 基于角色的访问控制 (RBAC)
- 最小权限原则
- 职责分离
- 临时权限提升

### 数据保护

- 传输加密 (TLS 1.3)
- 存储加密 (AES-256-GCM)
- 敏感数据脱敏
- 数据分类分级

### 监控和响应

- 实时安全监控
- 异常行为检测
- 安全事件响应
- 取证能力

## 合规要求

### ISO 27001

- A.9 访问控制
- A.10 密码学
- A.12 运营安全
- A.13 通信安全
- A.14 系统获取、开发与维护

### GDPR

- 第5条: 数据处理原则
- 第6条: 数据处理的合法性
- 第17条: 删除权（被遗忘权）

### 等保2.0

- 安全通信网络
- 安全区域边界
- 安全计算环境
- 安全管理中心
